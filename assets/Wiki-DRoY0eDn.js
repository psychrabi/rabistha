const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddWikiModal-aCpIsAgu.js","assets/index-TPnzWnce.js","assets/index-B_dmC73d.css","assets/jodit-react-BC7XpgN_.js","assets/index.esm-_6oSPjYL.js","assets/adminStore-Bsd_0KLZ.js"])))=>i.map(i=>d[i]);
import{b as P,p as C,r as i,j as e,_}from"./index-TPnzWnce.js";import{F as $}from"./Filter-psYszsYY.js";import{u as g}from"./adminStore-Bsd_0KLZ.js";import{P as L}from"./Pagination-DS4DXqF1.js";import{P as M}from"./plus-BlXKrtCs.js";import{P as F}from"./pencil-Blp6BNr7.js";import{E as B}from"./eye-XSoV2OG7.js";import{T as O}from"./trash-2-D9Y4E6D7.js";const h="http://localhost:4000",z=P(C((r,n)=>({wikis:[],categories:[],loading:!1,error:null,fetchWikis:async()=>{r({loading:!0,error:null});try{const t=await fetch(`${h}/api/wikis`);if(!t.ok)throw new Error("Failed to fetch wikis");const a=await t.json();console.log(a),r({wikis:Array.isArray(a)?a:[],loading:!1})}catch(t){r({error:t.message,loading:!1})}},fetchCategories:async()=>{r({loading:!0,error:null});try{const a=await(await fetch(`${h}/api/categories`)).json();r({categories:Array.isArray(a)?a:[],loading:!1})}catch(t){r({error:t.message,loading:!1})}},addWiki:async t=>{const a=g.getState().token;try{const o=await fetch(`${h}/api/admin/wikis`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(t)});if(!o.ok)throw new Error("Failed to add wiki");return o.json()}catch(o){r({error:o.message})}},updateWiki:async(t,a)=>{const o=g.getState().token;try{if(!(await fetch(`${h}/api/admin/wikis/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(a)})).ok)throw new Error("Failed to update wiki");await n().fetchWikis()}catch(m){r({error:m.message})}},deleteWiki:async t=>{const a=g.getState().token;try{if(confirm("Are you sure you want to delete this wiki?")){if(!(await fetch(`${h}/api/admin/wikis/${t}`,{method:"DELETE",Authorization:`Bearer ${a}`})).ok)throw new Error("Failed to delete wiki");await n().fetchWikis()}}catch(o){r({error:o.message})}}}),{name:"wiki-store"})),D=i.lazy(()=>_(()=>import("./AddWikiModal-aCpIsAgu.js"),__vite__mapDeps([0,1,2,3,4,5])));function K(){const{wikis:r,fetchWikis:n,deleteWiki:t,fetchCategories:a,categories:o}=z(),[m,p]=i.useState([]),[l,k]=i.useState(""),[c,w]=i.useState("all"),[d,j]=i.useState("all"),[y,b]=i.useState(1),[x]=i.useState(8),N=(Array.isArray(r)?r:[]).filter(s=>{if(l===""&&c==="all"&&d==="all")return!0;const W=l===""||s.title.toLowerCase().includes(l.toLowerCase()),E=c==="all"||s.type===c,T=d==="all"||s.status===d;return W&&E&&T})||[],u=y*x,S=u-x,f=N.slice(S,u),v=()=>{p(null),document.getElementById("addWikiModal").showModal()},A=s=>{p(s),document.getElementById("addWikiModal").showModal()};return i.useEffect(()=>{n(),a()},[n,a]),e.jsxs("section",{className:"w-full p-6 overflow-y-auto h-full",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-gray-100 mb-2",children:"Wiki Management"}),e.jsx("p",{className:"text-slate-600 dark:text-gray-300",children:"Manage ASTER Wikis from here"})]}),e.jsxs("button",{type:"button",onClick:()=>v(),className:"flex items-center justify-center w-1/2 px-5 py-2 text-sm tracking-wide text-white transition-colors duration-200 bg-blue-500 rounded-lg sm:w-auto gap-x-2 hover:bg-blue-600 dark:hover:bg-blue-500 dark:bg-blue-600",children:[e.jsx(M,{className:"w-5 h-5"}),e.jsx("span",{children:"Add a new Wiki"})]}),e.jsx(D,{currentWiki:m})]})}),e.jsx($,{setFilterStatus:j,setSearchTerm:k,setFilterType:w,searchTerm:l,filterType:c,filterStatus:d,categories:o}),e.jsx("div",{className:"overflow-hidden border border-gray-200 dark:border-gray-700 md:rounded-lg mb-4",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400",children:"Title"}),e.jsx("th",{scope:"col",className:"px-4 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400",children:"Category"}),e.jsx("th",{scope:"col",className:"px-4 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400",children:"Last Updated"}),e.jsx("th",{scope:"col",className:"px-4 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 dark:divide-gray-700 dark:bg-gray-900",children:f.length>0?f.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-500 dark:text-gray-300 whitespace-nowrap",children:s.title}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-500 dark:text-gray-300 whitespace-nowrap",children:s.category.name}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-500 dark:text-gray-300 whitespace-nowrap",children:new Date(s.updatedAt).toLocaleDateString()}),e.jsxs("td",{className:"px-4 py-2 text-sm whitespace-nowrap",children:[e.jsx("button",{onClick:()=>A(s),className:"text-yellow-600 hover:text-yellow-900 m-2 ",children:e.jsx(F,{})}),e.jsx("button",{onClick:()=>window.open(`/wiki/${s.slug}`,"_blank"),className:"text-blue-600 hover:text-blue-900 m-2",children:e.jsx(B,{})}),e.jsx("button",{onClick:()=>t(s),className:"text-red-600 hover:text-red-900 m-2",children:e.jsx(O,{})})]})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-8 text-slate-500",children:l||c!=="all"||d!=="all"?"No wikis match your filters.":"No wikis available. Add some wikis to get started."})})})]})}),e.jsx(L,{perPage:x,currentPage:y,setCurrentPage:b,total:r.length})]})}export{K as default};
