import{f as c,p as l}from"./index-CQqMSyWK.js";const n="http://localhost:4000/api",s=c(l(r=>({isAuthenticated:!1,admin:null,token:null,licenses:[],sales:[],users:[],quotes:[],login:async e=>{try{const a=await(await fetch("http://localhost:4000/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return a.token?(r({isAuthenticated:!0,admin:a.adminWithoutPassword,token:a.token}),!0):!1}catch(t){return console.error("Login failed:",t),!1}},logout:()=>{r({isAuthenticated:!1,admin:null,token:null})},fetchLicenses:async()=>{try{const e=await fetch(`${n}/admin/licenses`,{headers:{Authorization:`Bearer ${s.getState().token}`}});if(!e.ok)throw new Error("Failed to fetch licenses");const a=(await e.json()).map(o=>({...o,purchaseDate:new Date(o.purchaseDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),soldDate:o.soldDate?new Date(o.soldDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):null,lastDeactivated:o.lastDeactivated?new Date(o.lastDeactivated).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):null}));r({licenses:a})}catch(e){console.error("Error fetching licenses:",e),r({licenses:[]})}},fetchQuotes:async()=>{try{const t=await(await fetch("http://localhost:4000/api/admin/quotes",{headers:{Authorization:`Bearer ${s.getState().token}`}})).json();r({quotes:t})}catch(e){console.error("Error fetching quotes:",e)}},fetchSales:async()=>{try{const e=await fetch(`${n}/admin/sales`,{headers:{Authorization:`Bearer ${s.getState().token}`}});if(!e.ok)throw new Error("Failed to fetch sales");const t=await e.json();r({sales:t})}catch(e){console.error("Error fetching sales:",e),r({sales:[]})}},fetchUsers:async()=>{try{const e=await fetch(`${n}/admin/users`,{headers:{Authorization:`Bearer ${s.getState().token}`}});if(!e.ok)throw new Error("Failed to fetch users");const t=await e.json();r({users:t})}catch(e){console.error("Error fetching users:",e),r({users:[]})}},revokeLicense:async e=>{try{const t=await fetch(`${n}/admin/licenses/${e}/deactivate`,{method:"POST",headers:{Authorization:`Bearer ${s.getState().token}`}});if(!t.ok)throw new Error("Failed to revoke license");(await t.json()).success&&r(o=>({licenses:o.licenses.map(i=>i.id===e?{...i,status:"deactivated"}:i)}))}catch(t){console.error("Error revoking license:",t)}},addLicense:async e=>{try{const t=await fetch(`${n}/admin/licenses`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.getState().token}`},body:JSON.stringify({licenses:e})});if(!t.ok)throw new Error("Failed to add licenses");(await t.json()).success&&await r(o=>({...o})).fetchLicenses()}catch(t){console.error("Error adding licenses:",t)}}}),{name:"admin-storage"}));export{s as u};
