import{r as a,a as x,j as t}from"./index-CI7UZADU.js";import{J as g}from"./jodit-react-CPqeQI_E.js";import{u as j,C as y}from"./index.esm-DFqDlOEg.js";import{u as N}from"./adminStore-C86RxTd8.js";const k=({currentWiki:s})=>{const d=a.useRef(null),{register:r,handleSubmit:n,control:c,reset:o}=j({defaultValues:{currentWiki:s}}),{token:i,fetchCategories:m,categories:u}=N(),h=x(),p=a.useMemo(()=>({readonly:!1,height:600,uploader:{url:"http://localhost:4000/api/admin/wiki/upload",headers:{Authorization:`Bearer ${i}`},defaultHandlerSuccess:e=>e.file?e.file.url:null,process:e=>({files:[e.file],error:e.error?[e.error]:[]})},toolbarAdaptive:!1,buttons:["source","|","bold","italic","underline","strikethrough","|","ul","ol","|","indent","outdent","|","font","fontsize","brush","paragraph","|","image","file","table","link","|","align","undo","redo","|","hr","eraser","fullsize"],events:{beforeImage:e=>(e.style.maxWidth="100%",e.style.height="auto",e)},style:{color:"#000"}}),[]),b=async e=>{try{const l=s?"PUT":"POST",f=s?`http://localhost:4000/api/admin/wikis/${s.id}`:"http://localhost:4000/api/admin/wikis";(await fetch(f,{method:l,headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(e)})).status===200&&(document.getElementById("addWikiModal").close(),h("/admin/wikis",{replace:!0}),o())}catch(l){console.error("Error saving wiki:",l)}};return a.useEffect(()=>{console.log(s),m(),s&&o({title:s.title,content:s.content,categoryId:s.categoryId})},[s,o]),t.jsx("dialog",{className:"modal",id:"addWikiModal",children:t.jsxs("div",{className:"modal-box w-11/12 max-w-5xl",children:[t.jsxs("form",{onSubmit:n(b),children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block mb-2",children:"Category"}),t.jsx("select",{...r("categoryId",{required:"Category is required"}),className:"select w-full px-3 py-2 border rounded",children:u.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block mb-2",children:"Title"}),t.jsx("input",{...r("title",{required:"Title is required"}),className:"w-full px-3 py-2 border rounded",placeholder:"Enter wiki title"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block mb-2",children:"Content"}),t.jsx(y,{name:"content",control:c,rules:{required:"Content is required"},render:({field:{onChange:e,value:l}})=>t.jsx(g,{ref:d,value:l,config:p,onChange:e})})]}),t.jsx("div",{className:"modal-action",children:t.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:[s?"Update":"Create"," Wiki"]})})]}),t.jsx("form",{method:"dialog",children:t.jsx("button",{className:"btn",children:"Cancel"})})]})})};export{k as default};
