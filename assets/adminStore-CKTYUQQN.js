import{f as c,p as h}from"./index-e1O8DFM-.js";const n="http://localhost:4000/api",o=c(h(a=>({isAuthenticated:!1,admin:null,token:null,licenses:[],sales:[],users:[],wikis:[],faqs:[],quotes:[],login:async e=>{try{const s=await(await fetch(`${n}/admin/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return s.token?(a({isAuthenticated:!0,admin:s.adminWithoutPassword,token:s.token}),!0):!1}catch(t){return console.error("Login failed:",t),!1}},logout:()=>{a({isAuthenticated:!1,admin:null,token:null})},fetchLicenses:async()=>{try{const e=await fetch(`${n}/admin/licenses`,{headers:{Authorization:`Bearer ${o.getState().token}`}});if(!e.ok)throw new Error("Failed to fetch licenses");const s=(await e.json()).map(r=>({...r,purchaseDate:new Date(r.purchaseDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),soldDate:r.soldDate?new Date(r.soldDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):null,lastDeactivated:r.lastDeactivated?new Date(r.lastDeactivated).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):null}));a({licenses:s})}catch(e){console.error("Error fetching licenses:",e),a({licenses:[]})}},fetchWikis:async()=>{try{const t=await(await fetch("http://localhost:4000/api/wikis",{headers:{Authorization:`Bearer ${o.getState().token}`}})).json();a({wikis:t})}catch(e){console.error("Error fetching wikis:",e)}},fetchFAQs:async()=>{try{const t=await(await fetch("http://localhost:4000/api/faqs",{headers:{Authorization:`Bearer ${o.getState().token}`}})).json();a({faqs:t})}catch(e){console.error("Error fetching faqs:",e)}},fetchQuotes:async()=>{try{const t=await(await fetch("http://localhost:4000/api/admin/quotes",{headers:{Authorization:`Bearer ${o.getState().token}`}})).json();a({quotes:t})}catch(e){console.error("Error fetching quotes:",e)}},deleteWiki:async e=>{confirm("Are you sure you want to delete this wiki?")&&await fetch(`http://localhost:4000/api/admin/wikis/${e.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${o.getState().token}`}})},deleteFAQ:async e=>{confirm("Are you sure you want to delete this faq?")&&await fetch(`http://localhost:4000/api/admin/faqs/${e.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${o.getState().token}`}})},fetchSales:async()=>{try{const e=await fetch(`${n}/admin/sales`,{headers:{Authorization:`Bearer ${o.getState().token}`}});if(!e.ok)throw new Error("Failed to fetch sales");const t=await e.json();a({sales:t})}catch(e){console.error("Error fetching sales:",e),a({sales:[]})}},fetchUsers:async()=>{try{const e=await fetch(`${n}/admin/users`,{headers:{Authorization:`Bearer ${o.getState().token}`}});if(!e.ok)throw new Error("Failed to fetch users");const t=await e.json();a({users:t})}catch(e){console.error("Error fetching users:",e),a({users:[]})}},revokeLicense:async e=>{try{const t=await fetch(`${n}/admin/licenses/${e}/deactivate`,{method:"POST",headers:{Authorization:`Bearer ${o.getState().token}`}});if(!t.ok)throw new Error("Failed to revoke license");(await t.json()).success&&a(r=>({licenses:r.licenses.map(i=>i.id===e?{...i,status:"deactivated"}:i)}))}catch(t){console.error("Error revoking license:",t)}},addLicense:async e=>{try{const t=await fetch(`${n}/admin/licenses`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.getState().token}`},body:JSON.stringify({licenses:e})});if(!t.ok)throw new Error("Failed to add licenses");(await t.json()).success&&await a(r=>({...r})).fetchLicenses()}catch(t){console.error("Error adding licenses:",t)}}}),{name:"admin-storage"}));export{o as u};
