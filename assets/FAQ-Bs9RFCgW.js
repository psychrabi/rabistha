import{r as a,a as M,j as e}from"./index-DWhQH8N9.js";import{J as P}from"./jodit-react-D8RBMX-t.js";import{u as E,C as F}from"./index.esm-lhwI6miF.js";import{u as w}from"./adminStore-DnMRCSrj.js";import{F as L}from"./Filter-BTHZtz9J.js";import{P as q}from"./Pagination-BjD2eoN1.js";import{P as R}from"./plus-DTb5gehh.js";import{P as z}from"./pencil-CFk4MrsF.js";import{T as O}from"./trash-2-BpO1rJ-4.js";const U=({currentFAQ:t,onClose:b})=>{const f=a.useRef(null),d=a.useRef(null),{register:m,handleSubmit:n,control:p,reset:o}=E({defaultValues:{currentFAQ:t}}),{token:h}=w(),i=M(),g=a.useMemo(()=>({readonly:!1,height:600,uploader:{url:"http://localhost:4000/api/admin/faq/upload",headers:{Authorization:`Bearer ${h}`},defaultHandlerSuccess:s=>s.file?s.file.url:null,process:s=>({files:[s.file],error:s.error?[s.error]:[]})},toolbarAdaptive:!1,buttons:["source","|","bold","italic","underline","strikethrough","|","ul","ol","|","indent","outdent","|","font","fontsize","brush","paragraph","|","image","file","table","link","|","align","undo","redo","|","hr","eraser","fullsize"],events:{beforeImage:s=>(s.style.maxWidth="100%",s.style.height="auto",s)},style:{color:"#000"}}),[]),x=async s=>{try{const l=t?"PUT":"POST",y=t?`http://localhost:4000/api/admin/faqs/${t.id}`:"http://localhost:4000/api/admin/faqs",c=await fetch(y,{method:l,headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify(s)});c.status===200&&(console.log(c),i(0))}catch(l){console.error("Error saving faq:",l)}};return a.useEffect(()=>{console.log(t),t&&o({title:t.title,content:t.content,category:t.category}),d.current&&d.current.showModal()},[t,o]),e.jsx("dialog",{className:"modal",id:"addFAQModal",children:e.jsxs("div",{className:"modal-box w-11/12 max-w-5xl",children:[e.jsxs("form",{onSubmit:n(x),children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-2",children:"Title"}),e.jsx("input",{...m("title",{required:"Title is required"}),className:"w-full px-3 py-2 border rounded",placeholder:"Enter faq title"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-2",children:"Content"}),e.jsx(F,{name:"content",control:p,rules:{required:"Content is required"},render:({field:{onChange:s,value:l}})=>e.jsx(P,{ref:f,theme:"dark",value:l,config:g,onChange:s})})]}),e.jsx("div",{className:"modal-action",children:e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:[t?"Update":"Create"," FAQ"]})})]}),e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn",children:"Cancel"})})]})})};function G(){const{faqs:t,fetchFAQs:b,deleteFAQ:f}=w(),[d,m]=a.useState([]),[n,p]=a.useState(""),[o,h]=a.useState("all"),[i,g]=a.useState("all"),[x,s]=a.useState(1),[l]=a.useState(12),[y,c]=a.useState(!1),N=()=>{m(null),c(!0)},v=(t==null?void 0:t.filter(r=>{if(n===""&&o==="all"&&i==="all")return!0;const C=n===""||r.title.toLowerCase().includes(n.toLowerCase()),A=o==="all"||r.type===o,T=i==="all"||r.status===i;return C&&A&&T}))||[],j=x*l,S=j-l,u=v.slice(S,j),k=r=>new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return a.useEffect(()=>{b(),console.log(d)},[]),e.jsxs("section",{className:"w-full p-6 overflow-y-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-gray-100 mb-2",children:"FAQ Management"}),e.jsx("p",{className:"text-slate-600 dark:text-gray-300",children:"Manage ASTER FAQs from here"})]}),e.jsxs("button",{type:"button",onClick:()=>N(),className:"flex items-center justify-center w-1/2 px-5 py-2 text-sm tracking-wide text-white transition-colors duration-200 bg-blue-500 rounded-lg sm:w-auto gap-x-2 hover:bg-blue-600 dark:hover:bg-blue-500 dark:bg-blue-600",children:[e.jsx(R,{className:"w-5 h-5"}),e.jsx("span",{children:"Add a new FAQ"})]}),y&&e.jsx(U,{currentFAQ:d,onClose:()=>c(!1)})]})}),e.jsx(L,{setFilterStatus:g,setSearchTerm:p,setFilterType:h,searchTerm:n,filterType:o,filterStatus:i}),e.jsx("div",{className:"overflow-hidden border border-gray-200 dark:border-gray-700 md:rounded-lg mb-4",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-sm",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-3.5 font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400",children:"Title"}),e.jsx("th",{scope:"col",className:"w-32 px-4 py-3.5 font-normal text-center rtl:text-right text-gray-500 dark:text-gray-400",children:"Last Updated"}),e.jsx("th",{scope:"col",className:"w-32 px-4 py-3.5 font-normal text-center rtl:text-right text-gray-500 dark:text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 dark:divide-gray-700 dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:u.length>0?u==null?void 0:u.map(r=>e.jsxs("tr",{className:"text-sm",children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-medium",children:r.title}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-center",children:k(r.updatedAt)}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap font-medium",children:[e.jsx("button",{onClick:()=>{m(r),document.getElementById("addFAQModal").showModal()},className:"text-yellow-600 hover:text-yellow-900 mx-2",children:e.jsx(z,{})}),e.jsx("button",{onClick:()=>f(r),className:"text-red-600 hover:text-red-900 mx-2",children:e.jsx(O,{})})]})]},r.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-8 text-slate-500",children:n||o!=="all"||i!=="all"?"No faqs match your filters.":"No faqs available. Add some faqs to get started."})})})]})}),e.jsx(q,{perPage:l,currentPage:x,setCurrentPage:s,total:t.length})]})}export{G as default};
