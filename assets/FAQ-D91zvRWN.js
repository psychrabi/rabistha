import{r,a as T,j as e}from"./index-BSV5OHTS.js";import{J as q}from"./jodit-react-DnOCKFwj.js";import{u as M,C as E}from"./index.esm-ezgKkqFq.js";import{u as j}from"./adminStore-GvjlJW47.js";import{F}from"./Filter-ivuh1shx.js";import{P}from"./Pagination-CqcvFzIf.js";import{P as L}from"./plus-BN2yszXs.js";import{P as Q}from"./pencil-Xdo1gyVX.js";import{T as R}from"./trash-2-DT9b9bKC.js";const z=({currentFAQ:s})=>{const f=r.useRef(null),c=r.useRef(null),{register:p,handleSubmit:m,control:o,reset:u}=M({defaultValues:{currentFAQ:s}}),{token:l}=j(),g=T(),n=r.useMemo(()=>({readonly:!1,height:600,uploader:{url:"http://localhost:4000/api/admin/faq/upload",headers:{Authorization:`Bearer ${l}`},defaultHandlerSuccess:t=>t.file?t.file.url:null,process:t=>({files:[t.file],error:t.error?[t.error]:[]})},toolbarAdaptive:!1,buttons:["source","|","bold","italic","underline","strikethrough","|","ul","ol","|","indent","outdent","|","font","fontsize","brush","paragraph","|","image","file","table","link","|","align","undo","redo","|","hr","eraser","fullsize"],events:{beforeImage:t=>(t.style.maxWidth="100%",t.style.height="auto",t)},style:{color:"#000"}}),[]),y=async t=>{try{const i=s?"PUT":"POST",d=s?`http://localhost:4000/api/admin/faqs/${s.id}`:"http://localhost:4000/api/admin/faqs",h=await fetch(d,{method:i,headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(t)});h.status===200&&(console.log(h),g(0))}catch(i){console.error("Error saving faq:",i)}};return r.useEffect(()=>{console.log(s),s&&u({question:s.question,answer:s.answer,category:s.category}),c.current&&c.current.showModal()},[s,u]),e.jsx("dialog",{className:"modal",id:"addFAQModal",children:e.jsxs("div",{className:"modal-box w-11/12 max-w-5xl",children:[e.jsxs("form",{onSubmit:m(y),children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-2",children:"Title"}),e.jsx("input",{...p("question",{required:"Title is required"}),className:"w-full px-3 py-2 border rounded",placeholder:"Enter faq question"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-2",children:"Content"}),e.jsx(E,{name:"answer",control:o,rules:{required:"Content is required"},render:({field:{onChange:t,value:i}})=>e.jsx(q,{ref:f,theme:"dark",value:i,config:n,onChange:t})})]}),e.jsx("div",{className:"modal-action",children:e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:[s?"Update":"Create"," FAQ"]})})]}),e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn",children:"Cancel"})})]})})};function W(){const{faqs:s,fetchFAQs:f,deleteFAQ:c}=j(),[p,m]=r.useState([]),[o,u]=r.useState(""),[l,g]=r.useState("all"),[n,y]=r.useState("all"),[t,i]=r.useState(1),[d]=r.useState(12),h=()=>{m(null),document.getElementById("addFAQModal").showModal()},w=a=>{m(a),document.getElementById("addFAQModal").showModal()},N=(Array.isArray(s)?s:[]).filter(a=>{if(o===""&&l==="all"&&n==="all")return!0;const S=o===""||a.question.toLowerCase().includes(o.toLowerCase()),A=l==="all"||a.type===l,C=n==="all"||a.status===n;return S&&A&&C})||[],b=t*d,v=b-d,x=N.slice(v,b),k=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return r.useEffect(()=>{f(),console.log(s)},[]),e.jsxs("section",{className:"w-full p-6 overflow-y-auto",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-gray-100 mb-2",children:"FAQ Management"}),e.jsx("p",{className:"text-slate-600 dark:text-gray-300",children:"Manage ASTER FAQs from here"})]}),e.jsxs("button",{type:"button",onClick:()=>h(),className:"flex items-center justify-center w-1/2 px-5 py-2 text-sm tracking-wide text-white transition-colors duration-200 bg-blue-500 rounded-lg sm:w-auto gap-x-2 hover:bg-blue-600 dark:hover:bg-blue-500 dark:bg-blue-600",children:[e.jsx(L,{className:"w-5 h-5"}),e.jsx("span",{children:"Add a new FAQ"})]}),e.jsx(z,{currentFAQ:p})]})}),e.jsx(F,{setFilterStatus:y,setSearchTerm:u,setFilterType:g,searchTerm:o,filterType:l,filterStatus:n}),e.jsx("div",{className:"overflow-hidden border border-gray-200 dark:border-gray-700 md:rounded-lg mb-4",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-sm",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-3.5 font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400",children:"Title"}),e.jsx("th",{scope:"col",className:"w-32 px-4 py-3.5 font-normal text-center rtl:text-right text-gray-500 dark:text-gray-400",children:"Last Updated"}),e.jsx("th",{scope:"col",className:"w-32 px-4 py-3.5 font-normal text-center rtl:text-right text-gray-500 dark:text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 dark:divide-gray-700 dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:x.length>0?x==null?void 0:x.map(a=>e.jsxs("tr",{className:"text-sm",children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-medium",children:a.question}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-center",children:k(a.updatedAt)}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap font-medium",children:[e.jsx("button",{onClick:()=>w(a),className:"text-yellow-600 hover:text-yellow-900 m-2 ",children:e.jsx(Q,{})}),e.jsx("button",{onClick:()=>c(a),className:"text-red-600 hover:text-red-900 m-2",children:e.jsx(R,{})})]})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-8 text-slate-500",children:o||l!=="all"||n!=="all"?"No faqs match your filters.":"No faqs available. Add some faqs to get started."})})})]})}),e.jsx(P,{perPage:d,currentPage:t,setCurrentPage:i,total:s.length})]})}export{W as default};
