import{d as p,a as j,r as h,j as e}from"./index-ChX-6Ru7.js";import{u as f}from"./adminStore-ykny_srM.js";import{C as g}from"./circle-check-big-DeD6UgQV.js";const v=()=>{const u=p(),d=j(),[r,x]=h.useState(null),{licenses:N}=f();return h.useEffect(()=>{const t=new URLSearchParams(u.search).get("orderId");if(!t){d("/cart");return}const n=JSON.parse(localStorage.getItem("currentOrder")||"null");if(n&&n.id===t){const i=JSON.parse(localStorage.getItem("orders")||"[]").map(a=>a.id===t?{...a,paymentStatus:"completed"}:a);localStorage.setItem("orders",JSON.stringify(i)),localStorage.removeItem("currentOrder"),x({...n,paymentStatus:"completed"});const o=JSON.parse(localStorage.getItem("licenses")||"[]"),c=o.filter(a=>a.orderId===t);if(c.length>0){const a=o.map(s=>s.orderId===t?{...s,status:"sold"}:s);localStorage.setItem("licenses",JSON.stringify(a)),setPurchasedLicenses(c.map(s=>({...s,status:"sold"})))}}else{const m=JSON.parse(localStorage.getItem("orders")||"[]"),i=m.find(s=>s.id===t);if(!i){d("/cart");return}const o=m.map(s=>s.id===t?{...s,paymentStatus:"completed"}:s);localStorage.setItem("orders",JSON.stringify(o)),x({...i,paymentStatus:"completed"});const c=JSON.parse(localStorage.getItem("licenses")||"[]"),a=c.filter(s=>s.orderId===t);if(a.length>0){const s=c.map(l=>l.orderId===t?{...l,status:"sold"}:l);localStorage.setItem("licenses",JSON.stringify(s)),setPurchasedLicenses(a.map(l=>({...l,status:"sold"})))}}},[u.search,d]),r?e.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(g,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Payment Successful!"}),e.jsx("p",{className:"text-gray-600",children:"Thank you for your purchase"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Order Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Order ID"}),e.jsx("span",{className:"font-medium",children:r.id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Payment Status"}),e.jsx("span",{className:"text-green-600 capitalize",children:r.paymentStatus})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["$",r.subtotal.toFixed(2)]})]}),r.discount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["-$",r.discount.toFixed(2)]})]}),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",r.total.toFixed(2)]})]})})]})]}),purchasedLicenses.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Purchased Licenses (",purchasedLicenses.length,")"]}),e.jsx("div",{className:"space-y-4",children:purchasedLicenses.map((t,n)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-medium",children:["License #",n+1]}),e.jsx("span",{className:"text-green-600 capitalize",children:t.status})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"License Key"}),e.jsx("span",{className:"font-mono",children:t.key})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Valid Until"}),e.jsx("span",{children:new Date(t.validUntil).toLocaleDateString()})]})]})]},t.key))})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:()=>d("/"),className:"btn btn-primary",children:"Return to Home"})})]}):null};export{v as default};
