import{r as i,a as g,j as e}from"./index-DL9P-VcI.js";import{J as f}from"./jodit-react-9P0GdpB9.js";import{u as b,C as j}from"./index.esm-Cy5ByagH.js";import{u as x}from"./adminStore-m4gDAwBq.js";import{P as y}from"./plus-oKP9d1PR.js";const w=({currentWiki:s})=>{const c=i.useRef(null),{register:r,handleSubmit:o,control:n,reset:d}=b({defaultValues:{currentWiki:s}}),{token:l}=x(),m=g(),u=i.useMemo(()=>({readonly:!1,height:600,uploader:{url:"http://localhost:4000/api/admin/wiki/upload",headers:{Authorization:`Bearer ${l}`},defaultHandlerSuccess:t=>t.file?t.file.url:null,process:t=>({files:[t.file],error:t.error?[t.error]:[]})},toolbarAdaptive:!1,buttons:["source","|","bold","italic","underline","strikethrough","|","ul","ol","|","indent","outdent","|","font","fontsize","brush","paragraph","|","image","file","table","link","|","align","undo","redo","|","hr","eraser","fullsize"],events:{beforeImage:t=>(t.style.maxWidth="100%",t.style.height="auto",t)},style:{color:"#000"}}),[]),h=async t=>{console.log({onsubmit:t});try{const a=s?"PUT":"POST",p=s?`http://localhost:4000/api/admin/wikis/${s.id}`:"http://localhost:4000/api/admin/wikis";(await fetch(p,{method:a,headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(t)})).status===200&&m("/admin/wikis")}catch(a){console.error("Error saving wiki:",a)}};return i.useEffect(()=>{console.log(s),s&&d({title:s.title,content:s.content,category:s.category})},[s,d]),e.jsx("dialog",{className:"modal",id:"addWikiModal",children:e.jsxs("div",{className:"modal-box w-11/12 max-w-5xl",children:[e.jsxs("form",{onSubmit:o(h),children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-2",children:"Category"}),e.jsxs("select",{...r("category",{required:"Category is required"}),className:"select w-full px-3 py-2 border rounded",children:[e.jsx("option",{value:"quick-start-guite",children:"Quick Start Guide"}),e.jsx("option",{value:"user-manual",children:"User Manual"}),e.jsx("option",{value:"faqs",children:"FAQs"}),e.jsx("option",{value:"solutions",children:"Solutions"}),e.jsx("option",{value:"version-history",children:"Version History"}),e.jsx("option",{value:"useful-links",children:"Useful Link"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-2",children:"Title"}),e.jsx("input",{...r("title",{required:"Title is required"}),className:"w-full px-3 py-2 border rounded",placeholder:"Enter wiki title"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-2",children:"Content"}),e.jsx(j,{name:"content",control:n,rules:{required:"Content is required"},render:({field:{onChange:t,value:a}})=>e.jsx(f,{ref:c,value:a,config:u,onChange:t})})]}),e.jsx("div",{className:"modal-action",children:e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:[s?"Update":"Create"," Wiki"]})})]}),e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn",children:"Cancel"})})]})})};function A(){const{wikis:s,fetchWikis:c,deleteWiki:r}=x(),[o,n]=i.useState([]),d=()=>{n(null),document.getElementById("addWikiModal").showModal()};return i.useEffect(()=>{c(),console.log(o)},[]),e.jsxs("section",{className:"w-full p-6 overflow-y-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-gray-100 mb-2",children:"Wiki Management"}),e.jsx("p",{className:"text-slate-600 dark:text-gray-300",children:"Manage ASTER Wikis from here"})]}),e.jsxs("button",{type:"button",onClick:()=>d(),className:"flex items-center justify-center w-1/2 px-5 py-2 text-sm tracking-wide text-white transition-colors duration-200 bg-blue-500 rounded-lg sm:w-auto gap-x-2 hover:bg-blue-600 dark:hover:bg-blue-500 dark:bg-blue-600",children:[e.jsx(y,{className:"w-5 h-5"}),e.jsx("span",{children:"Add a new Wiki"})]}),e.jsx(w,{currentWiki:o})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Updated"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.length>0?s.map(l=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.title})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.category})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:new Date(l.updatedAt).toLocaleDateString()})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>{n(l),document.getElementById("addWikiModal").showModal()},className:"text-yellow-600 hover:text-yellow-900 mx-2",children:"Edit"}),e.jsx("button",{onClick:()=>window.open(`/wiki/${l.slug}`,"_blank"),className:"text-blue-600 hover:text-blue-900 mx-2",children:"View"}),e.jsx("button",{onClick:()=>r(l),className:"text-red-600 hover:text-red-900 mx-2",children:"Delete"})]})]},l.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-8 text-slate-500",children:searchTerm||filterType!=="all"||filterStatus!=="all"?"No wikis match your filters.":"No wikis available. Add some wikis to get started."})})})]})})]})}export{A as default};
